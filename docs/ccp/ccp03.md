# 第三章 系统总线

### 3.1 总线的基本概念

总线是连接各个部件的信息传输线，是各个部件共享的传输介质

总线上信息的传送：串行、并行

1.单总线结构框图

![ccp03-01](/images/ccp03-01.png ':size=40%')

2.面向CPU的双总线结构框图

![ccp03-02](/images/ccp03-02.png ':size=40%')

3.以存储器为中心的双总线结构框图

![ccp03-03](/images/ccp03-03.png ':size=40%')

### 3.2 总线的分类

1. 片内总线：芯片内部的总线
2. 系统总线：计算机个部件之间的信息传输线
   + 数据总线   双向    与机器字长、存储字长有关
   + 地址总线   单向    与存储地址、I/O地址有关
   + 控制总线   有出 有入
3. 通信总线：用于计算机系统之间或计算机系统与其他系统（如控制仪表、移动通信等）之间的通信
    + 串行通信
    + 并行通信

### 3.3 总线的特性及性能指标

总线的特性
1. 机械特性：尺寸、形状、管脚数及排列顺序
2. 电气特性：传输方向和有效的电平范围
3. 功能特性：每根传输线的功能
   + 地址
   + 数据
   + 控制 
4. 时间特性：信号的时序关系

总线的性能指标
1. 总线宽度：数据线的根数
2. 标准传输率：每秒传输的最大字节数(MBps)
3. 时钟同步/异步：同步、不同不
4. 总线复用：地址线与数据线复用
5. 信号线数：地址线、数据线和控制线的总和
6. 总线控制方式：突发、自动、仲裁、逻辑、计数
7. 其他指标：负载能力

总线的标准

![ccp03-04](/images/ccp03-04.png ':size=70%')

### 3.4 总线结构

单总线结构

多总线结构

1.双总线结构

![ccp03-05](/images/ccp03-05.png ':size=50%')

2.三总线结构

![ccp03-06](/images/ccp03-06.png ':size=50%')

3.三总线结构又一形式

![ccp03-07](/images/ccp03-07.png ':size=50%')

4.四总线结构

![ccp03-08](/images/ccp03-08.png ':size=50%')

### 3.5 总线的控制

一、总线判优控制

+ 主设备   对总线有控制权
+ 从设备   响应从主设备发来的总线命令

总线的判优控制分为集中式和分布式

集中式有以下三种

1.链式查询方式：仅用2根线实现，容易扩展，但对电路故障敏感

![ccp03-09](/images/ccp03-09.png ':size=40%')

2.计数器定时查询方式：优先次序可以改变，但是要用log<sub>2</sub>n根线

![ccp03-10](/images/ccp03-10.png ':size=40%')

3.独立请求方式：响应速度快，优先次序控制灵活，但是需要2n根线

![ccp03-11](/images/ccp03-11.png ':size=40%')

二、总线通信控制

目的：解决通信双方协调配合问题

总线传输周期
+ 申请分配阶段：主模块申请，总线总裁决定
+ 寻址阶段：主模块向从模块给出地址和命令
+ 传输阶段：主模块和从模块交换数据
+ 结束阶段：主模块撤销有关信息

总线通信的四种方式
+ 同步通信：由统一时标控制数据传送
+ 异步通信：采用应答方式，没有公共时钟标准
+ 半同步通信：同步、异步结合
+ 分离式通信：充分挖掘系统总线每个瞬间潜力

异步通信的应答方式：

![ccp03-12](/images/ccp03-12.png ':size=50%')

同步、异步、半同步通信的共同点：
一个总线传输周期
+ 主模块发地址、命令 占用总线
+ 从模块准备数据  不占用总线，总线空闲
+ 从模块向主模块发数据  占用总线

分离式通信:
一个总线传输周期
+ 子周期1   主模块申请占用总线，使用完后即放弃总线的使用权
+ 子周期2   从模块申请占用总线，将各种信息送至总线上

分离式通信特点：
1. 各模块有权申请占用总线
2. 采用同步方式通信，不等对方回答
3. 各模块准备数据时，不占用总线
4. 总线被占用时，无空闲
